# gt-ndfix
### Quick C++ project to read through Type-1 GRETINA events, and perform corrections for neutron-damage


# Analysis steps:
* Let's assume that there are two source Global.dat.gz files at in /path/to/file/Run0150/Global.dat.gz and /path/to/file/Run0151/Global.dat.gz
* These contain GT data in Type-1 format, over a range of crystals, possibly neutron damaged
* Our first step is to plot 2D ROOT histograms of the e_tot values in these segments against position:
    * For the coaxial part of the crystal (beta, gamma, ... phi segments) it is the cylindrical rho = sqrt(x<sup>2</sup> + y<sup>2</sup>) of the interaction point with maximum 'e' value. The trend is piecewise-linear
    * For the segment with lowest 'z' values (alpha), the 'z' coordinate of the interaction point with max 'e' value seems to show an empirical trend of a second order polynomial
* Since we do not have any idea about the neutron damage correction coefficients, we can comment out calls to readNeutronFixFile() readFineGTCalibFile() in extract.cxx and recompile.
* The above step makes sure that the 'finished' histograms aren't created at the output
* We now create the raw histograms showing the issue that we wish to correct for. Both the above sets of histograms are generated by running
'''
./extract /path/to/file/Run0150/Global.dat.gz
./extract /path/to/file/Run0151/Global.dat.gz
'''
* These create output files with histograms named '''output.root''' in each case, which will need to be renamed as say, Run0150.root and Run0151.root
* The output files will contain a folder 'cc' which will have histogram names like

xtal_r_vs_tote_x#27_s#3
xtal_z_vs_tote_x#27_s#0

and so on.

* These will show the empirical features that can be fit using the ROOT Macros gt_neutronfix_Nov24.C and gt_neutronfix_Nov24_ch0.C
* The first macro fits the coaxial part, the second fits the 'alpha' segment
* The results from running the macros above can be folded into the input file sought by the function readNeutronFixFile(). Both the correction types are stored in the same file. Poor decision maybe, but work in progress
* The FineGTCalibFile() can be generated by the user by going through each crystal to gain-match it after the steps above. More on this later.
